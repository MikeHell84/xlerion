import{m as l}from"./alpine-l7QTk8p_.js";import{a as i}from"./axios-D5GkNzM3.js";const n={auctions:[],currentAuction:null,bids:[],loading:!1,error:null,pollInterval:null,async fetchAuctions(t={}){var e,a;this.loading=!0;try{const{data:r}=await i.get("/api/auctions",{params:t});this.auctions=r.data||r,this.error=null}catch(r){this.error=((a=(e=r.response)==null?void 0:e.data)==null?void 0:a.message)||"Error fetching auctions",console.error("Auction fetch error:",r)}finally{this.loading=!1}},async fetchAuctionDetail(t){var e,a;this.loading=!0;try{const{data:r}=await i.get(`/api/auctions/${t}`);this.currentAuction=r.data||r,this.bids=r.bids||[],this.error=null}catch(r){this.error=((a=(e=r.response)==null?void 0:e.data)==null?void 0:a.message)||"Error fetching auction details",console.error("Auction detail error:",r)}finally{this.loading=!1}},async placeBid(t,e){var a,r;try{const{data:s}=await i.post(`/api/auctions/${t}/bids`,{amount:parseFloat(e)});return this.currentAuction=s.data||s,this.bids=s.bids||[],{success:!0,data:s}}catch(s){const o=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Error placing bid";return this.error=o,{success:!1,error:o}}},startPolling(t,e=5e3){this.pollInterval&&clearInterval(this.pollInterval),this.pollInterval=setInterval(()=>this.fetchAuctionDetail(t),e)},stopPolling(){this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null)}},c=(t,e=5e3)=>(n.startPolling(t,e),()=>n.stopPolling()),u={user:null,isAuthenticated:!1,loading:!1,error:null,async login(t,e){var a,r;this.loading=!0;try{const{data:s}=await i.post("/api/auth/login",{email:t,password:e});return this.user=s.user,this.isAuthenticated=!0,localStorage.setItem("authToken",s.token),this.error=null,{success:!0}}catch(s){const o=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Login failed";return this.error=o,{success:!1,error:o}}finally{this.loading=!1}},async register(t){var e,a;this.loading=!0;try{const{data:r}=await i.post("/api/auth/register",t);return this.user=r.user,this.isAuthenticated=!0,localStorage.setItem("authToken",r.token),this.error=null,{success:!0}}catch(r){const s=((a=(e=r.response)==null?void 0:e.data)==null?void 0:a.message)||"Registration failed";return this.error=s,{success:!1,error:s}}finally{this.loading=!1}},async logout(){try{await i.post("/api/auth/logout"),this.user=null,this.isAuthenticated=!1,localStorage.removeItem("authToken")}catch(t){console.error("Logout error:",t)}},checkAuth(){const t=localStorage.getItem("authToken");t&&(i.defaults.headers.common.Authorization=`Bearer ${t}`,this.isAuthenticated=!0)}},h=()=>{u.checkAuth()},d={show(t,e="info",a=3e3){const r=document.getElementById("toast-container")||this.createContainer(),s=document.createElement("div"),o={success:"bg-green-600",error:"bg-red-600",warning:"bg-yellow-600",info:"bg-blue-600"}[e]||"bg-blue-600";s.className=`${o} text-white px-6 py-3 rounded-lg shadow-lg animate-fade-in mb-2`,s.textContent=t,r.appendChild(s),setTimeout(()=>s.remove(),a)},createContainer(){const t=document.createElement("div");return t.id="toast-container",t.className="fixed top-4 right-4 z-50 max-w-md",document.body.appendChild(t),t},success(t,e){this.show(t,"success",e)},error(t,e){this.show(t,"error",e)},warning(t,e){this.show(t,"warning",e)},info(t,e){this.show(t,"info",e)}};window.Alpine=l;window.initAuctionPolling=c;window.initAuthStore=h;window.notificationService=d;l.start();
